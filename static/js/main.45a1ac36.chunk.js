(this["webpackJsonpworkday-schedule-exporter"]=this["webpackJsonpworkday-schedule-exporter"]||[]).push([[0],{13:function(e,t){},23:function(e,t,n){},30:function(e,t){},31:function(e,t){},33:function(e,t,n){},35:function(e,t,n){},36:function(e,t,n){"use strict";n.r(t);var r=n(1),a=n.n(r),c=n(14),l=n.n(c),s=(n(23),n(11)),i=n.n(s),d=n(15),o=n(16),u=n(4),h=n(5),f=n(7),p=n(2),j=n.n(p),v=n(8),b=n.n(v),S={SELECTING:"",SUCCESS:"File Successfully Uploaded! Downloading...",ERROR:"An Unexpected Error Occured: Check that the spreadsheet is a valid schedule"},O={DATES:{A:["2021-08-26","2021-10-13"],B:["2021-10-20","2021-12-10"],C:["2022-01-13","2022-03-04"],D:["2022-03-14","2022-05-02"]},SPECIAL_SCHEDULES:[["2021-08-25","MO","A"],["2021-01-12","MO","C"],["2021-05-03","FR","D"]]},m={M:"MO",T:"TU",W:"WE",R:"TH",F:"FR"},E=function(){function e(){Object(u.a)(this,e)}return Object(h.a)(e,null,[{key:"load",value:function(e,t){var n=this,r=new FileReader,a=!!r.readAsBinaryString;r.onload=function(e){var r=e.target.result,c=j.a.read(r,{type:a?"binary":"array"}),l=c.SheetNames[0],s=c.Sheets[l];n.convert(s,t)},a?r.readAsBinaryString(e):r.readAsArrayBuffer(e)}},{key:"convert",value:function(e,t){e["!ref"]="L16";for(var n=null,r=[],a=j.a.utils.decode_range("A1:K50"),c=3+a.s.r;c<a.e.r;c++)if(null!=e[j.a.utils.encode_cell({r:c,c:0})]){var l=e[j.a.utils.encode_cell({r:c,c:0})].v,s=e[j.a.utils.encode_cell({r:c,c:1})].v,i=e[j.a.utils.encode_cell({r:c,c:5})].v,d=e[j.a.utils.encode_cell({r:c,c:6})].v;if(null!=l){for(var o=l[l.indexOf("Term")-2],u=O.DATES[o],h=d.split(" | "),p=h[0].split("-"),v=0;v<p.length;v++)p[v]=m[p[v]];var E=h[1].split(" - "),x=b()(u[0]+" "+E[0],"YYYY-MM-DD h:m A"),C=b()(u[0]+" "+E[1],"YYYY-MM-DD h:m A"),y=b()(u[1]+" "+E[1],"YYYY-MM-DD h:m A"),w={title:s,location:h[2],description:i,start:new Date(x.format()),end:new Date(C.format()),recurrence:{frequency:"WEEKLY",weekdays:p,end:new Date(y.format())},term:o};null==n?n=new f.ICalendar(w):n.addEvent(new f.ICalendar(w)),r[r.length]=w}}for(var A=0;A<O.SPECIAL_SCHEDULES.length;A++)for(var D=O.SPECIAL_SCHEDULES[A],g=0;g<r.length;g++){if(r[g].recurrence.weekdays.includes(D[1])&&r[g].term===D[2]){var k={};Object.assign(k,r[g]),delete k.recurrence;var Y=D[0].split("-");k.start.setFullYear(Y[0]),k.start.setMonth(Y[1]-1),k.start.setDate(Y[2]),k.end.setFullYear(Y[0]),k.end.setMonth(Y[1]-1),k.end.setDate(Y[2]),n.addEvent(new f.ICalendar(k))}}n?(n.download("Workday Schedule.ics"),t(S.SUCCESS)):t(S.ERROR)}}]),e}(),x=n(6),C=n(18),y=n(17),w=["xlsx","xlsb","xlsm","xls","xml","csv","txt","ods","fods","uos","sylk","dif","dbf","prn","qpw","123","wb*","wq*","html","htm"].map((function(e){return"."+e})).join(","),A=(n(33),n(0)),D=function(e){Object(C.a)(n,e);var t=Object(y.a)(n);function n(e){var r;return Object(u.a)(this,n),(r=t.call(this,e)).handleChange=r.handleChange.bind(Object(x.a)(r)),r}return Object(h.a)(n,[{key:"handleChange",value:function(e){var t=e.target.files;t&&t[0]&&this.props.handleFile(t[0])}},{key:"render",value:function(){return Object(A.jsxs)("form",{className:"FileInputButton",children:[Object(A.jsx)("label",{htmlFor:"file",children:this.props.children}),Object(A.jsx)("input",{type:"file",id:"file",accept:w,onChange:this.handleChange})]})}}]),n}(a.a.Component);n(35);var g=function(){var e=Object(r.useState)(S.SELECTING),t=Object(o.a)(e,2),n=t[0],a=t[1],c=function(){var e=Object(d.a)(i.a.mark((function e(t){return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:E.load(t,a);case 1:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();return Object(A.jsxs)("div",{className:"App",children:[Object(A.jsxs)("header",{className:"App-header",children:[Object(A.jsx)("h1",{children:"Workday Schedule Exporter"}),Object(A.jsx)("p",{children:"Upload an .XLSX or .CSV spreadsheet and convert it to an .ICS"})]}),Object(A.jsx)(D,{handleFile:function(e){return function(e){c(e)}(e)},children:"Select File"}),Object(A.jsx)("p",{children:n}),Object(A.jsx)("footer",{className:"App-footer",children:Object(A.jsx)("p",{children:"Made by Adam Kalayjian and Kai Nakamura"})})]})};l.a.render(Object(A.jsx)(a.a.StrictMode,{children:Object(A.jsx)(g,{})}),document.getElementById("root"))}},[[36,1,2]]]);
//# sourceMappingURL=main.45a1ac36.chunk.js.map