(this["webpackJsonpworkday-schedule-exporter"]=this["webpackJsonpworkday-schedule-exporter"]||[]).push([[0],{13:function(e,n){},23:function(e,n,t){},30:function(e,n){},31:function(e,n){},33:function(e,n,t){},35:function(e,n,t){},36:function(e,n,t){"use strict";t.r(n);var a=t(1),r=t.n(a),c=t(14),l=t.n(c),i=(t(23),t(10)),s=t.n(i),o=t(15),d=t(16),u=t(4),h=t(5),f=t(11),p=t(2),j=t.n(p),b=t(7),O=t.n(b),v={SELECTING:"",SUCCESS:"File Successfully Uploaded! Downloading...",ERROR:"An Unexpected Error Occured: Check that the spreadsheet is a valid schedule"},x={DATES:{A:["2021-08-25","2021-10-13"],B:["2021-10-20","2021-12-10"],C:["2022-01-25","2022-03-04"],D:["2022-03-14","2022-05-03"]},SPECIAL_SCHEDULES:{"2021-8-25":"MO","2021-1-12":"MO","2021-5-3":"FR"}},S={M:"MO",T:"TU",W:"WE",R:"TH",F:"FR"},m=function(){function e(){Object(u.a)(this,e)}return Object(h.a)(e,null,[{key:"load",value:function(e,n){var t=this,a=new FileReader,r=!!a.readAsBinaryString;a.onload=function(e){var a=e.target.result,c=j.a.read(a,{type:r?"binary":"array"}),l=c.SheetNames[0],i=c.Sheets[l];t.convert(i,n)},r?a.readAsBinaryString(e):a.readAsArrayBuffer(e)}},{key:"convert",value:function(e,n){e["!ref"]="L16";for(var t=null,a=j.a.utils.decode_range("A1:K50"),r=4+a.s.r;r<a.e.r;r++)if(null!=e[j.a.utils.encode_cell({r:r,c:0})]){var c=e[j.a.utils.encode_cell({r:r,c:0})].v,l=e[j.a.utils.encode_cell({r:r,c:1})].v,i=e[j.a.utils.encode_cell({r:r,c:5})].v,s=e[j.a.utils.encode_cell({r:r,c:6})].v;if(null!=c){for(var o=c[c.indexOf("Term")-2],d=x.DATES[o],u=s.split(" | "),h=u[0].split("-"),p=0;p<h.length;p++)h[p]=S[h[p]];var b=u[1].split(" - "),m=O()(d[0]+" "+b[0],"YYYY-MM-DD h:m A"),y=O()(d[0]+" "+b[1],"YYYY-MM-DD h:m A"),C=O()(d[1]+" "+b[1],"YYYY-MM-DD h:m A"),E={title:l,location:u[2],description:i,start:new Date(m.format()),end:new Date(y.format()),recurrence:{frequency:"WEEKLY",weekdays:h,end:new Date(C.format())}};null==t?t=new f.ICalendar(E):t.addEvent(new f.ICalendar(E))}}t?(t.download("Workday Schedule.ics"),n(v.SUCCESS)):n(v.ERROR)}}]),e}(),y=t(6),C=t(18),E=t(17),w=["xlsx","xlsb","xlsm","xls","xml","csv","txt","ods","fods","uos","sylk","dif","dbf","prn","qpw","123","wb*","wq*","html","htm"].map((function(e){return"."+e})).join(","),A=(t(33),t(0)),k=function(e){Object(C.a)(t,e);var n=Object(E.a)(t);function t(e){var a;return Object(u.a)(this,t),(a=n.call(this,e)).handleChange=a.handleChange.bind(Object(y.a)(a)),a}return Object(h.a)(t,[{key:"handleChange",value:function(e){var n=e.target.files;n&&n[0]&&this.props.handleFile(n[0])}},{key:"render",value:function(){return Object(A.jsxs)("form",{className:"FileInputButton",children:[Object(A.jsx)("label",{htmlFor:"file",children:this.props.children}),Object(A.jsx)("input",{type:"file",id:"file",accept:w,onChange:this.handleChange})]})}}]),t}(r.a.Component);t(35);var D=function(){var e=Object(a.useState)(v.SELECTING),n=Object(d.a)(e,2),t=n[0],r=n[1],c=function(){var e=Object(o.a)(s.a.mark((function e(n){return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:m.load(n,r);case 1:case"end":return e.stop()}}),e)})));return function(n){return e.apply(this,arguments)}}();return Object(A.jsxs)("div",{className:"App",children:[Object(A.jsxs)("header",{className:"App-header",children:[Object(A.jsx)("h1",{children:"Workday Schedule Exporter"}),Object(A.jsx)("p",{children:"Upload an .XLSX or .CSV spreadsheet and convert it to an .ICS"})]}),Object(A.jsx)(k,{handleFile:function(e){return function(e){c(e)}(e)},children:"Select File"}),Object(A.jsx)("p",{children:t}),Object(A.jsx)("footer",{className:"App-footer",children:Object(A.jsx)("p",{children:"Made by Adam Kalayjian and Kai Nakamura"})})]})};l.a.render(Object(A.jsx)(r.a.StrictMode,{children:Object(A.jsx)(D,{})}),document.getElementById("root"))}},[[36,1,2]]]);
//# sourceMappingURL=main.deedb640.chunk.js.map