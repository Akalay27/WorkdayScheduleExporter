{"version":3,"sources":["components/file-input/FileInputDragDrop.js","components/file-input/SheetJSFT.js","components/file-input/FileInputButton.js","components/util/Converter.js","App.js","index.js"],"names":["FileInputDragDrop","props","state","counter","onDragEnter","bind","onDragLeave","onDrop","evt","stopPropagation","preventDefault","this","suppress","setState","files","dataTransfer","handleFile","onDragOver","className","children","React","Component","SheetJSFT","map","x","join","FileInputButton","handleChange","e","target","htmlFor","type","id","accept","onChange","initialOptions","dates","specialSchedules","weekdayNames","converter","file","convert","sheet","calendar","range","XLSX","utils","decode_range","console","log","rowNum","BLANK_ROWS","s","r","encode_cell","c","termCell","nameCell","formatCell","locationTimeAndDayCell","term","indexOf","termDates","splitMPatterns","split","weekdays","day","length","times","startTimestamp","moment","endTimestamp","finishTimestamp","options","title","location","description","start","Date","format","end","recurrence","frequency","ICalendar","addEvent","download","reader","FileReader","rABS","readAsBinaryString","onload","bstr","result","wb","read","wsname","SheetNames","ws","Sheets","readAsArrayBuffer","load","App","useState","setFile","onClick","a","ReactDOM","render","StrictMode","document","getElementById"],"mappings":"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","file":"static/js/main.a574b1ac.chunk.js","sourcesContent":["import React from 'react';\nimport './FileInputDragDrop.css';\n\nclass FileInputDragDrop extends React.Component {\n\tconstructor(props) {\n\t\tsuper(props);\n\t\tthis.state = {counter: 0};\n\t\tthis.onDragEnter = this.onDragEnter.bind(this)\n\t\tthis.onDragLeave = this.onDragLeave.bind(this)\n\t\tthis.onDrop = this.onDrop.bind(this);\n\t}\n\tsuppress(evt) {\n\t\tevt.stopPropagation();\n\t\tevt.preventDefault();\n\t}\n\tonDragEnter(evt) {\n\t\tthis.suppress(evt);\n\t\tthis.setState({\n\t\t\tcounter: this.state.counter + 1\n\t\t});\n\t}\n\tonDragLeave(evt) {\n\t\tthis.suppress(evt);\n\t\tthis.setState({\n\t\t\tcounter: this.state.counter - 1\n\t\t});\n\t}\n\tonDrop(evt) {\n\t\tthis.suppress(evt);\n\t\tconst files = evt.dataTransfer.files;\n\t\tif (files && files[0]) {\n\t\t\tthis.setState({\n\t\t\t\tcounter: 0\n\t\t\t});\n\t\t\tthis.props.handleFile(files[0]);\n\t\t}\n\t}\n\trender() {\n\t\treturn (\n\t\t\t<div\n\t\t\t\tonDrop={this.onDrop}\n\t\t\t\tonDragEnter={this.onDragEnter}\n\t\t\t\tonDragLeave={this.onDragLeave}\n\t\t\t\tonDragOver={this.suppress}\n\t\t\t\tclassName={\"FileInputDragDrop\" + (this.state.counter === 0 ? \"\" : \" active\")}\n\t\t\t>\n\t\t\t\t{this.props.children}\n\t\t\t</div>\n\t\t);\n\t}\n}\n\nexport default FileInputDragDrop;","const SheetJSFT = [\n\t\"xlsx\",\n\t\"xlsb\",\n\t\"xlsm\",\n\t\"xls\",\n\t\"xml\",\n\t\"csv\",\n\t\"txt\",\n\t\"ods\",\n\t\"fods\",\n\t\"uos\",\n\t\"sylk\",\n\t\"dif\",\n\t\"dbf\",\n\t\"prn\",\n\t\"qpw\",\n\t\"123\",\n\t\"wb*\",\n\t\"wq*\",\n\t\"html\",\n\t\"htm\"\n].map(\n\tfunction(x) {\n\t\treturn \".\" + x;\n\t}\n).join(\",\");\n\nexport default SheetJSFT;","import React from 'react';\nimport SheetJSFT from './SheetJSFT';\nimport './FileInputButton.css';\n\nclass FileInputButton extends React.Component {\n\tconstructor(props) {\n\t\tsuper(props);\n\t\tthis.handleChange = this.handleChange.bind(this);\n\t}\n\thandleChange(e) {\n\t\tconst files = e.target.files;\n\t\tif (files && files[0]) {\n\t\t\tthis.props.handleFile(files[0]);\n\t\t}\n\t}\n\trender() {\n\t\treturn (\n\t\t\t<form className=\"FileInputButton\">\n\t\t\t\t<label htmlFor=\"file\">Select File</label>\n\t\t\t\t<input\n\t\t\t\t\ttype=\"file\"\n\t\t\t\t\tid=\"file\"\n\t\t\t\t\taccept={SheetJSFT}\n\t\t\t\t\tonChange={this.handleChange}\n\t\t\t\t/>\n\t\t\t</form>\n\t\t);\n\t}\n}\n\nexport default FileInputButton;","import { ICalendar } from \"datebook\";\nimport { Promise, reject } from \"q\"\nimport React, {useState} from \"react\"\nimport XLSX from \"xlsx\"\nimport moment from 'moment'\nconst BLANK_ROWS = 3;\n\nfunction converter(file) {\n\t\n\tconst load = (file) => {\n\t\tconst reader = new FileReader();\n\t\tconst rABS = !!reader.readAsBinaryString;\n\t\treader.onload = e => {\n\t\t\t/* Parse data */\n\t\t\tconst bstr = e.target.result;\n\t\t\tconst wb = XLSX.read(bstr, { type: rABS ? \"binary\" : \"array\" });\n\t\t\t/* Get the first worksheet */\n\t\t\tconst wsname = wb.SheetNames[0];\n\t\t\tconst ws = wb.Sheets[wsname];\n\t\t\tconsole.log(rABS, wb);\n\t\t\t/* Convert to row object array */\n\t\t\t/* Run converter */\n\t\t\tconvert(ws);\n\t\t}\n\t\tif (rABS) reader.readAsBinaryString(file);\n\t\telse reader.readAsArrayBuffer(file);\n\t}\n\n\tconst convert = (sheet) => {\n\t\tsheet[\"!ref\"] = 'L16'\n\t\tvar calendar = null;\n\t\t\n\t\tvar range = XLSX.utils.decode_range('A1:K50');\n\t\tconsole.log(sheet);\n\t\tconsole.log(range);\n\t\tfor (var rowNum = BLANK_ROWS+1 + range.s.r; rowNum < range.e.r; rowNum++) {\n\t\t\t// check if next class row exists\n\t\t\tif (sheet[XLSX.utils.encode_cell({r: rowNum, c: 0})] != null) {\n\t\t\t\t// read necessary cells\n\t\t\t\tlet termCell = sheet[XLSX.utils.encode_cell({r: rowNum, c: 0})]['v'];\n\t\t\t\tlet nameCell = sheet[XLSX.utils.encode_cell({r: rowNum, c: 1})]['v'];\n\t\t\t\tlet formatCell = sheet[XLSX.utils.encode_cell({r: rowNum, c: 5})]['v'];\n\t\t\t\tlet locationTimeAndDayCell = sheet[XLSX.utils.encode_cell({r: rowNum, c: 6})]['v'];\n\t\t\t\t//let professorCell = sheet[XLSX.utils.encode_cell({r: rowNum, c: 8})]['v'];\n\t\t\t\tif (termCell != null) {\n\t\t\t\t\t// example: ...2021 Fall B Term -> B \n\t\t\t\t\tlet term = termCell[termCell.indexOf(\"Term\") - 2];\n\t\t\t\t\tlet termDates = initialOptions.dates[term];\n\t\t\t\t\t// split all info in \"Meeting Patterns\" cell\n\t\t\t\t\tlet splitMPatterns = locationTimeAndDayCell.split(\" | \");\n\t\t\t\t\tlet weekdays = splitMPatterns[0].split(\"-\");\n\t\t\t\t\t// convert day abbreviations to those recognized by Datebook\n\t\t\t\t\tfor (var day = 0; day < weekdays.length; day++) {\n\t\t\t\t\t\tweekdays[day] = weekdayNames[weekdays[day]];\n\t\t\t\t\t}\n\n\t\t\t\t\t// read times from Meeting Patterns\n\t\t\t\t\tlet times = splitMPatterns[1].split(\" - \");\n\t\t\t\t\t\n\t\t\t\t\tlet startTimestamp = moment(termDates[0] + \" \" + times[0], \"YYYY-MM-DD h:m A\");\n\t\t\t\t\tlet endTimestamp = moment(termDates[0] + \" \" + times[1], \"YYYY-MM-DD h:m A\");\n\t\t\t\t\tlet finishTimestamp = moment(termDates[1] + \" \" + times[1], \"YYYY-MM-DD h:m A\");\n\t\t\t\t\t\n\t\t\t\t\tlet options = {\n\t\t\t\t\t\ttitle: nameCell,\n\t\t\t\t\t\tlocation: splitMPatterns[2],\n\t\t\t\t\t\tdescription: formatCell,\n\t\t\t\t\t\tstart: new Date(startTimestamp.format()),\n\t\t\t\t\t\tend: new Date(endTimestamp.format()),\n\t\t\t\t\t\trecurrence: {\n\t\t\t\t\t\t\tfrequency: 'WEEKLY',\n\t\t\t\t\t\t\tweekdays: weekdays,\n\t\t\t\t\t\t\tend: new Date(finishTimestamp.format()),\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\n\t\t\t\t\tif (calendar == null)\n\t\t\t\t\t\tcalendar = new ICalendar(options);\n\t\t\t\t\telse\n\t\t\t\t\t\tcalendar.addEvent(new ICalendar(options));\n\t\t\t\t\t\n\t\t\t\t}\n\t\t\t}\t\n\t\t}\n\t\tconsole.log(calendar.download(\"testCalendar.ics\"));\n\n\t}\n\n\tload(file);\n\n}\n\n/* generate an array of column objects */\nconst make_cols = refstr => {\n\tlet o = [],\n\tC = XLSX.utils.decode_range(refstr).e.c + 1;\n\tfor (var i = 0; i < C; ++i) \n\t\to[i] = { name: XLSX.utils.encode_col(i), key: i };\n\n\treturn o;\n};\n\nconst initialOptions = {\n\tdates: \n\t{\n\t\t'A': [\"2021-08-25\",\"2021-10-13\"],\n\t\t'B': [\"2021-10-20\",\"2021-12-10\"],\n\t\t'C': [\"2022-01-25\",\"2022-03-04\"],\n\t\t'D': [\"2022-03-14\",\"2022-05-03\"],\n\t},\n\tspecialSchedules:\n\t{\n\t\t'2021-8-25': 'MO',\n\t\t'2021-1-12': 'MO',\n\t\t'2021-5-3': 'FR' // not going to deal with this one at the moment.\n\t}\n\t// add the weird days to switch\n}\n\nconst weekdayNames = {\n\t'M': 'MO',\n\t'T': 'TU',\n\t'W': 'WE',\n\t'R': 'TH',\n\t'F': 'FR'\n}\nexport default converter;","import FileInputDragDrop from './components/file-input/FileInputDragDrop'\nimport FileInputButton from './components/file-input/FileInputButton'\nimport './App.css';\nimport {useState} from 'react'\n\nimport converter from './components/util/Converter';\nfunction App() {\n\tconst [file, setFile] = useState();\n\t\n\treturn (\n\t\t<div className=\"App\">\n\t\t\t<FileInputDragDrop handleFile={(file) => {setFile(file)}}>\n\t\t\t\t<p>Drop to Upload</p>\n\t\t\t</FileInputDragDrop>\n\t\t\t<header className=\"App-header\">\n\t\t\t\t<h1>Workday Schedule Exporter</h1>\n\t\t\t\t<p>Upload an .XLSX spreadsheet from \"View My Courses\" and convert it to an .ICS or Outlook link.</p>\n\t\t\t</header>\n\t\t\t<FileInputButton handleFile={(file) => setFile(file)}/>\n\t\t\t<button onClick={async () => {\n\t\t\t\tconverter(file)\n\t\t\t}}>Convert</button>\n\t\t</div>\n\t);\n}\n\nexport default App;\n","import React from 'react';\nimport ReactDOM from 'react-dom';\nimport './index.css';\nimport App from './App';\n\nReactDOM.render(\n  <React.StrictMode>\n    <App />\n  </React.StrictMode>,\n  document.getElementById('root')\n);\n\n"],"sourceRoot":""}