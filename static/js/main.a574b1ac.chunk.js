(this["webpackJsonpworkday-schedule-exporter"]=this["webpackJsonpworkday-schedule-exporter"]||[]).push([[0],{16:function(e,t){},24:function(e,t,n){},26:function(e,t,n){},28:function(e,t,n){},29:function(e,t,n){},37:function(e,t){},38:function(e,t){},40:function(e,t,n){"use strict";n.r(t);var r=n(1),a=n.n(r),o=n(17),s=n.n(o),c=(n(24),n(13)),i=n.n(c),l=n(18),u=n(19),d=n(5),h=n(6),p=n(3),f=n(8),j=n(7),v=(n(26),n(0)),b=function(e){Object(f.a)(n,e);var t=Object(j.a)(n);function n(e){var r;return Object(d.a)(this,n),(r=t.call(this,e)).state={counter:0},r.onDragEnter=r.onDragEnter.bind(Object(p.a)(r)),r.onDragLeave=r.onDragLeave.bind(Object(p.a)(r)),r.onDrop=r.onDrop.bind(Object(p.a)(r)),r}return Object(h.a)(n,[{key:"suppress",value:function(e){e.stopPropagation(),e.preventDefault()}},{key:"onDragEnter",value:function(e){this.suppress(e),this.setState({counter:this.state.counter+1})}},{key:"onDragLeave",value:function(e){this.suppress(e),this.setState({counter:this.state.counter-1})}},{key:"onDrop",value:function(e){this.suppress(e);var t=e.dataTransfer.files;t&&t[0]&&(this.setState({counter:0}),this.props.handleFile(t[0]))}},{key:"render",value:function(){return Object(v.jsx)("div",{onDrop:this.onDrop,onDragEnter:this.onDragEnter,onDragLeave:this.onDragLeave,onDragOver:this.suppress,className:"FileInputDragDrop"+(0===this.state.counter?"":" active"),children:this.props.children})}}]),n}(a.a.Component),O=["xlsx","xlsb","xlsm","xls","xml","csv","txt","ods","fods","uos","sylk","dif","dbf","prn","qpw","123","wb*","wq*","html","htm"].map((function(e){return"."+e})).join(","),D=(n(28),function(e){Object(f.a)(n,e);var t=Object(j.a)(n);function n(e){var r;return Object(d.a)(this,n),(r=t.call(this,e)).handleChange=r.handleChange.bind(Object(p.a)(r)),r}return Object(h.a)(n,[{key:"handleChange",value:function(e){var t=e.target.files;t&&t[0]&&this.props.handleFile(t[0])}},{key:"render",value:function(){return Object(v.jsxs)("form",{className:"FileInputButton",children:[Object(v.jsx)("label",{htmlFor:"file",children:"Select File"}),Object(v.jsx)("input",{type:"file",id:"file",accept:O,onChange:this.handleChange})]})}}]),n}(a.a.Component)),g=(n(29),n(14)),x=(n(30),n(2)),m=n.n(x),y=n(9),k=n.n(y);var w={dates:{A:["2021-08-25","2021-10-13"],B:["2021-10-20","2021-12-10"],C:["2022-01-25","2022-03-04"],D:["2022-03-14","2022-05-03"]},specialSchedules:{"2021-8-25":"MO","2021-1-12":"MO","2021-5-3":"FR"}},C={M:"MO",T:"TU",W:"WE",R:"TH",F:"FR"},S=function(e){var t=function(e){e["!ref"]="L16";var t=null,n=m.a.utils.decode_range("A1:K50");console.log(e),console.log(n);for(var r=4+n.s.r;r<n.e.r;r++)if(null!=e[m.a.utils.encode_cell({r:r,c:0})]){var a=e[m.a.utils.encode_cell({r:r,c:0})].v,o=e[m.a.utils.encode_cell({r:r,c:1})].v,s=e[m.a.utils.encode_cell({r:r,c:5})].v,c=e[m.a.utils.encode_cell({r:r,c:6})].v;if(null!=a){for(var i=a[a.indexOf("Term")-2],l=w.dates[i],u=c.split(" | "),d=u[0].split("-"),h=0;h<d.length;h++)d[h]=C[d[h]];var p=u[1].split(" - "),f=k()(l[0]+" "+p[0],"YYYY-MM-DD h:m A"),j=k()(l[0]+" "+p[1],"YYYY-MM-DD h:m A"),v=k()(l[1]+" "+p[1],"YYYY-MM-DD h:m A"),b={title:o,location:u[2],description:s,start:new Date(f.format()),end:new Date(j.format()),recurrence:{frequency:"WEEKLY",weekdays:d,end:new Date(v.format())}};null==t?t=new g.ICalendar(b):t.addEvent(new g.ICalendar(b))}}console.log(t.download("testCalendar.ics"))};!function(e){var n=new FileReader,r=!!n.readAsBinaryString;n.onload=function(e){var n=e.target.result,a=m.a.read(n,{type:r?"binary":"array"}),o=a.SheetNames[0],s=a.Sheets[o];console.log(r,a),t(s)},r?n.readAsBinaryString(e):n.readAsArrayBuffer(e)}(e)};var Y=function(){var e=Object(r.useState)(),t=Object(u.a)(e,2),n=t[0],a=t[1];return Object(v.jsxs)("div",{className:"App",children:[Object(v.jsx)(b,{handleFile:function(e){a(e)},children:Object(v.jsx)("p",{children:"Drop to Upload"})}),Object(v.jsxs)("header",{className:"App-header",children:[Object(v.jsx)("h1",{children:"Workday Schedule Exporter"}),Object(v.jsx)("p",{children:'Upload an .XLSX spreadsheet from "View My Courses" and convert it to an .ICS or Outlook link.'})]}),Object(v.jsx)(D,{handleFile:function(e){return a(e)}}),Object(v.jsx)("button",{onClick:Object(l.a)(i.a.mark((function e(){return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:S(n);case 1:case"end":return e.stop()}}),e)}))),children:"Convert"})]})};s.a.render(Object(v.jsx)(a.a.StrictMode,{children:Object(v.jsx)(Y,{})}),document.getElementById("root"))}},[[40,1,2]]]);
//# sourceMappingURL=main.a574b1ac.chunk.js.map